var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};











var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();





var defineProperty = function (obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
};

var get = function get(object, property, receiver) {
  if (object === null) object = Function.prototype;
  var desc = Object.getOwnPropertyDescriptor(object, property);

  if (desc === undefined) {
    var parent = Object.getPrototypeOf(object);

    if (parent === null) {
      return undefined;
    } else {
      return get(parent, property, receiver);
    }
  } else if ("value" in desc) {
    return desc.value;
  } else {
    var getter = desc.get;

    if (getter === undefined) {
      return undefined;
    }

    return getter.call(receiver);
  }
};

var inherits = function (subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      enumerable: false,
      writable: true,
      configurable: true
    }
  });
  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
};











var possibleConstructorReturn = function (self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return call && (typeof call === "object" || typeof call === "function") ? call : self;
};





var slicedToArray = function () {
  function sliceIterator(arr, i) {
    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"]) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  return function (arr, i) {
    if (Array.isArray(arr)) {
      return arr;
    } else if (Symbol.iterator in Object(arr)) {
      return sliceIterator(arr, i);
    } else {
      throw new TypeError("Invalid attempt to destructure non-iterable instance");
    }
  };
}();













var toConsumableArray = function (arr) {
  if (Array.isArray(arr)) {
    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];

    return arr2;
  } else {
    return Array.from(arr);
  }
};

var Liquid$1=function(){function a(){classCallCheck(this,a);}return createClass(a,null,[{key:'initClass',value:function initClass(){this.FilterSeparator=/\|/,this.ArgumentSeparator=/,/,this.FilterArgumentSeparator=/\:/,this.VariableAttributeSeparator=/\./,this.TagStart=/\{\%/,this.TagEnd=/\%\}/,this.VariableSignature=/\(?[\w\-\.\[\]]\)?/,this.VariableSegment=/[\w\-]/,this.VariableStart=/\{\{/,this.VariableEnd=/\}\}/,this.VariableIncompleteEnd=/\}\}?/,this.QuotedString=/"[^"]*"|'[^']*'/,this.QuotedFragment=new RegExp(this.QuotedString.source+'|(?:[^\\s,\\|\'"]|'+this.QuotedString.source+')+'),this.StrictQuotedFragment=/"[^"]+"|'[^']+'|[^\s|:,]+/,this.FirstFilterArgument=new RegExp(this.FilterArgumentSeparator.source+'(?:'+this.StrictQuotedFragment.source+')'),this.OtherFilterArgument=new RegExp(this.ArgumentSeparator.source+'(?:'+this.StrictQuotedFragment.source+')'),this.SpacelessFilter=new RegExp('^(?:\'[^\']+\'|"[^"]+"|[^\'"])*'+this.FilterSeparator.source+'(?:'+this.StrictQuotedFragment.source+')(?:'+this.FirstFilterArgument.source+'(?:'+this.OtherFilterArgument.source+')*)?'),this.Expression=new RegExp('(?:'+this.QuotedFragment.source+'(?:'+this.SpacelessFilter.source+')*)'),this.TagAttributes=new RegExp('(\\w+)\\s*\\:\\s*('+this.QuotedFragment.source+')'),this.AnyStartingTag=/\{\{|\{\%/,this.PartialTemplateParser=new RegExp(this.TagStart.source+'.*?'+this.TagEnd.source+'|'+this.VariableStart.source+'.*?'+this.VariableIncompleteEnd.source),this.TemplateParser=new RegExp('('+this.PartialTemplateParser.source+'|'+this.AnyStartingTag.source+')'),this.VariableParser=new RegExp('\\[[^\\]]+\\]|'+this.VariableSegment.source+'+\\??');}}]),a}();Liquid$1.initClass(),Liquid$1.Error=Error,['ArgumentError','ContextError','FilterNotFound','FileSystemError','StandardError','StackLevelError','SyntaxError'].forEach(function(a){return Liquid$1[a]=Liquid$1.Error});

var Tag=function(){function a(b,c,d){classCallCheck(this,a),this.template=b,this.tagName=c,this.markup=d;}return createClass(a,[{key:'parseWithCallbacks',value:function parseWithCallbacks(){for(var f=this,c=arguments.length,b=Array(c),d=0;d<c;d++)b[d]=arguments[d];var e;return e=this.afterParse?function parse(){return f.parse.apply(f,b).then(function(){return f.afterParse.apply(f,b)})}:function parse(){return f.parse.apply(f,b)},this.beforeParse?Promise.resolve(this.beforeParse.apply(this,b)).then(e):e()}},{key:'parse',value:function parse(){}},{key:'name',value:function name(){return this.constructor.name.toLowerCase()}},{key:'render',value:function render(){return''}}]),a}();

var SyntaxHelp; var Syntax; var Assign=function(a){function b(c,d,e){classCallCheck(this,b);var g,f=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));if(g=Syntax.exec(e))f.to=g[1],f.from=new Liquid$1.Variable(g[2]);else throw new Liquid$1.SyntaxError(SyntaxHelp);return f}return inherits(b,a),createClass(b,null,[{key:'initClass',value:function initClass(){SyntaxHelp='Syntax Error in \'assign\' - Valid syntax: assign [var] = [source]',Syntax=new RegExp('((?:'+Liquid$1.VariableSignature.source+')+)\\s*=\\s*(.*)\\s*');}}]),createClass(b,[{key:'render',value:function render(c){return c.lastScope()[this.to]=this.from.render(c),get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'render',this).call(this,c)}}]),b}(Tag);Assign.initClass();

var BlankFileSystem=function(){function a(){classCallCheck(this,a);}return createClass(a,[{key:"readTemplateFile",value:function readTemplateFile(){return Promise.reject(new Liquid$1.FileSystemError("This file system doesn't allow includes"))}}]),a}();

var reduce=function(a,b,c){return Promise.all(a).then(function(d){return d.reduce(function(e,f,g,h){return e.then(function(i){return b(i,f,g,h)})},Promise.resolve(c))})};

var helpers = {flatten:function flatten(a){var c=[],b=function(d){return d.forEach(function(e){return Array.isArray(e)?b(e):c.push(e)})};return b(a),c},toFlatString:function toFlatString(a){return this.flatten(a).join('')},scan:function scan(a,b,c){null==c&&(c=!1);var e=[],d=function(f){var g=b.exec(f);if(g){1===g.length?e.push(g[0]):e.push(g.slice(1));var h=g[0].length;if(c&&(h=1),g.index+h<f.length)return d(f.substring(g.index+h))}};return d(a),e}};

var Drop=function(){function a(){classCallCheck(this,a);}return createClass(a,[{key:'hasKey',value:function hasKey(){return!0}},{key:'invokeDrop',value:function invokeDrop(b){if(this.constructor.isInvokable(b)){var c=this[b];return'function'==typeof c?c.call(this):c}return this.beforeMethod(b)}},{key:'beforeMethod',value:function beforeMethod(){}},{key:'get',value:function get$$1(b){return this.invokeDrop(b)}},{key:'toLiquid',value:function toLiquid(){return this}},{key:'toString',value:function toString(){return'[Liquid.Drop '+this.constructor.name+']'}}],[{key:'initClass',value:function initClass(){this.prototype.context=null;}},{key:'isInvokable',value:function isInvokable(b){var c=this;return null==this.invokableMethods&&(this.invokableMethods=function(){var d=Object.keys(a.prototype),e=['toLiquid'];return Object.keys(c.prototype).forEach(function(f){if(0>d.indexOf(f))return e.push(f)}),e}()),0<=this.invokableMethods.indexOf(b)}}]),a}();Drop.initClass();

var VariableNameFragment; var FilterListFragment; var FilterArgParser; var Variable=function(){function b(c){var h=this;classCallCheck(this,b),this.markup=c,this.name=null,this.filters=[];var d=VariableNameFragment.exec(this.markup);if(d&&(this.name=d[1],d=FilterListFragment.exec(d[2]),!!d)){var g=helpers.scan(d[1],b.FilterParser);g.forEach(function(i){if(d=/\s*(\w+)/.exec(i),!!d){var j=d[1],k=helpers.scan(i,FilterArgParser);return k=helpers.flatten(k),h.filters.push([j,k])}});}}return createClass(b,null,[{key:'initClass',value:function initClass(){this.FilterParser=new RegExp('(?:'+Liquid$1.FilterSeparator.source+'|(?:\\s*(?!(?:'+Liquid$1.FilterSeparator.source+'))(?:'+Liquid$1.QuotedFragment.source+'|\\S+)\\s*)+)'),VariableNameFragment=new RegExp('\\s*('+Liquid$1.QuotedFragment.source+')(.*)'),FilterListFragment=new RegExp(Liquid$1.FilterSeparator.source+'\\s*(.*)'),FilterArgParser=new RegExp('(?:'+Liquid$1.FilterArgumentSeparator.source+'|'+Liquid$1.ArgumentSeparator.source+')\\s*('+Liquid$1.QuotedFragment.source+')');}}]),createClass(b,[{key:'render',value:function render(c){var h=this,d=void 0;if(null==this.name)return'';var g=function(j,k){var l=k[1].map(function(m){return c.get(m)});return Promise.all([j].concat(toConsumableArray(l))).then(function(m){j=m.shift();try{return c.invoke.apply(c,[k[0],j].concat(toConsumableArray(m)))}catch(n){if(!(n instanceof Liquid$1.FilterNotFound))throw n;throw new Liquid$1.FilterNotFound('Error - filter \''+k[0]+'\' in \''+h.markup+'\' could not be found.')}})},i=Promise.resolve(c.get(this.name));switch(this.filters.length){case 0:d=i;break;case 1:d=g(i,this.filters[0]);break;default:d=reduce(this.filters,g,i);}return d.then(function(j){return j instanceof Drop?(j.context=c,j.toString()):j}).catch(function(j){return c.handleError(j)})}}]),b}();Variable.initClass();

var Promise_each=function(a,b){var c=function(d){if(d>=a.length)return Promise.resolve();var f=a[d];return Promise.resolve(f).then(function(g){return Promise.resolve(b(g)).then(function(){return c(d+1)})})};return c(0)}; var Block=function(a){function b(){return classCallCheck(this,b),possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return inherits(b,a),createClass(b,[{key:'beforeParse',value:function beforeParse(){return null==this.nodelist&&(this.nodelist=[]),this.nodelist.length=0}},{key:'afterParse',value:function afterParse(){return this.assertMissingDelimitation()}},{key:'parse',value:function parse(c){var f=this;if(0===c.length||this.ended)return Promise.resolve();var d=c.shift();return Promise.resolve().then(function(){return f.parseToken(d,c)}).catch(function(g){throw g.message=g.message+'\n    at '+d.value+' ('+d.filename+':'+d.line+':'+d.col+')',null==g.location&&(g.location={col:d.col,line:d.line,filename:d.filename}),g}).then(function(){return f.parse(c)})}},{key:'parseToken',value:function parseToken(c,d){if(b.IsTag.test(c.value)){var f=b.FullToken.exec(c.value);if(!f)throw new Liquid$1.SyntaxError('Tag \''+c.value+'\' was not properly terminated with regexp: '+Liquid$1.TagEnd.inspect);if(this.blockDelimiter()===f[1])return this.endTag();var g=this.template.tags[f[1]];if(!g)return this.unknownTag(f[1],f[2],d);var h=new g(this.template,f[1],f[2]);return this.nodelist.push(h),h.parseWithCallbacks(d)}if(b.IsVariable.test(c.value))return this.nodelist.push(this.createVariable(c));if(0===c.value.length);else return this.nodelist.push(c.value)}},{key:'endTag',value:function endTag(){return this.ended=!0}},{key:'unknownTag',value:function unknownTag(c){if('else'===c)throw new Liquid$1.SyntaxError(this.blockName()+' tag does not expect else tag');else if('end'===c)throw new Liquid$1.SyntaxError('\'end\' is not a valid delimiter for '+this.blockName()+' tags. use '+this.blockDelimiter());else throw new Liquid$1.SyntaxError('Unknown tag \''+c+'\'')}},{key:'blockDelimiter',value:function blockDelimiter(){return'end'+this.blockName()}},{key:'blockName',value:function blockName(){return this.tagName}},{key:'createVariable',value:function createVariable(c){var d=__guard__(b.ContentOfVariable.exec(c.value),function(f){return f[1]});if(d)return new Variable(d);throw new Liquid$1.SyntaxError('Variable \''+c.value+'\' was not properly terminated with regexp: '+Liquid$1.VariableEnd.inspect)}},{key:'render',value:function render(c){return this.renderAll(this.nodelist,c)}},{key:'assertMissingDelimitation',value:function assertMissingDelimitation(){if(!this.ended)throw new Liquid$1.SyntaxError(this.blockName()+' tag was never closed')}},{key:'renderAll',value:function renderAll(c,d){var f=[];return Promise_each(c,function(g){return'function'==typeof __guard__(g,function(h){return h.render})?Promise.resolve().then(function(){return g.render(d)}).then(function(h){return f.push(h)},function(h){return f.push(d.handleError(h))}):void f.push(g)}).then(function(){return f})}}],[{key:'initClass',value:function initClass(){this.IsTag=new RegExp('^'+Liquid$1.TagStart.source),this.IsVariable=new RegExp('^'+Liquid$1.VariableStart.source),this.FullToken=new RegExp('^'+Liquid$1.TagStart.source+'\\s*(\\w+)\\s*(.*)?'+Liquid$1.TagEnd.source+'$'),this.ContentOfVariable=new RegExp('^'+Liquid$1.VariableStart.source+'(.*)'+Liquid$1.VariableEnd.source+'$');}}]),b}(Tag);Block.initClass();function __guard__(a,b){return'undefined'!=typeof a&&null!==a?b(a):void 0}

var Syntax$1; var SyntaxHelp$1; var Capture=function(a){function b(c,d,e){classCallCheck(this,b);var f=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments)),g=Syntax$1.exec(e);if(g)f.to=g[1];else throw new Liquid$1.SyntaxError(SyntaxHelp$1);return f}return inherits(b,a),createClass(b,null,[{key:'initClass',value:function initClass(){Syntax$1=/(\w+)/,SyntaxHelp$1='Syntax Error in \'capture\' - Valid syntax: capture [var]';}}]),createClass(b,[{key:'render',value:function render(c){var d=this;return get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'render',this).apply(this,arguments).then(function(e){var f=Liquid$1.Helpers.toFlatString(e);return c.lastScope()[d.to]=f,''})}}]),b}(Block);Capture.initClass();

var Range=function(){function a(b,c,d){classCallCheck(this,a),this.start=b,this.end=c,null==d&&(d=0),this.step=d,0===this.step&&(this.end<this.start?this.step=-1:this.step=1),Object.seal(this);}return createClass(a,[{key:'some',value:function some(b){var g=this.start,c=this.end,d=this.step;if(0<d)for(;g<c;){if(b(g))return!0;g+=d;}else for(;g>c;){if(b(g))return!0;g+=d;}return!1}},{key:'forEach',value:function forEach(b){return this.some(function(c){return b(c),!1})}},{key:'toArray',value:function toArray$$1(){var b=[];return this.forEach(function(c){return b.push(c)}),b}}]),a}();Object.defineProperty(Range.prototype,'length',{get:function get$$1(){return Math.floor((this.end-this.start)/this.step)}});

var Context=function(){function a(j,l,m,n,p){var r=this;classCallCheck(this,a);var q;null==l&&(l={}),null==m&&(m={}),null==n&&(n={}),null==p&&(p=!1),this.environments=helpers.flatten([l]),this.scopes=[m],this.registers=n,this.errors=[],this.rethrowErrors=p,this.strainer=null==(q=__guard__$2(j,function(s){return new s.Strainer(r)}))?{}:q,this.squashInstanceAssignsWithEnvironments();}return createClass(a,null,[{key:'initClass',value:function initClass(){this.Literals={null:null,nil:null,'':null,true:!0,false:!1};}}]),createClass(a,[{key:'registerFilters',value:function registerFilters(){for(var l=arguments.length,j=Array(l),m=0;m<l;m++)j[m]=arguments[m];var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var p,n=Array.from(j)[Symbol.iterator]();!(_iteratorNormalCompletion=(p=n.next()).done);_iteratorNormalCompletion=!0){var q=p.value,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var s,r=Object.keys(q||{})[Symbol.iterator]();!(_iteratorNormalCompletion2=(s=r.next()).done);_iteratorNormalCompletion2=!0){var t=s.value,u=q[t];u instanceof Function&&(this.strainer[t]=u);}}catch(w){_didIteratorError2=!0,_iteratorError2=w;}finally{try{!_iteratorNormalCompletion2&&r.return&&r.return();}finally{if(_didIteratorError2)throw _iteratorError2}}}}catch(w){_didIteratorError=!0,_iteratorError=w;}finally{try{!_iteratorNormalCompletion&&n.return&&n.return();}finally{if(_didIteratorError)throw _iteratorError}}}},{key:'handleError',value:function handleError(j){if(this.errors.push(j),this.rethrowErrors)throw j;return j instanceof Liquid$1.SyntaxError?'Liquid syntax error: '+j.message:'Liquid error: '+j.message}},{key:'invoke',value:function invoke(j){var p=this.strainer[j];if(p instanceof Function){for(var m=arguments.length,l=Array(1<m?m-1:0),n=1;n<m;n++)l[n-1]=arguments[n];return p.apply(this.strainer,l)}var q=Object.keys(this.strainer);throw new Liquid$1.FilterNotFound('Unknown filter `'+j+'`, available: ['+q.join(', ')+']')}},{key:'push',value:function push(j){if(null==j&&(j={}),this.scopes.unshift(j),100<this.scopes.length)throw new Error('Nesting too deep')}},{key:'merge',value:function merge(j){var l=this;return null==j&&(j={}),function(){var m=[],_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var p,n=Object.keys(j||{})[Symbol.iterator]();!(_iteratorNormalCompletion3=(p=n.next()).done);_iteratorNormalCompletion3=!0){var q=p.value,r=j[q];m.push(l.scopes[0][q]=r);}}catch(s){_didIteratorError3=!0,_iteratorError3=s;}finally{try{!_iteratorNormalCompletion3&&n.return&&n.return();}finally{if(_didIteratorError3)throw _iteratorError3}}return m}()}},{key:'pop',value:function pop(){if(1>=this.scopes.length)throw new Error('ContextError');return this.scopes.shift()}},{key:'lastScope',value:function lastScope(){return this.scopes[this.scopes.length-1]}},{key:'stack',value:function stack(j,l){var p=this;null==j&&(j={});var m=!1;try{2>arguments.length&&(l=j,j={}),this.push(j);var n=l();return null!=__guard__$2(n,function(q){return q.nodeify})&&(m=!0,n.nodeify(function(){return p.pop()})),n}finally{m||this.pop();}}},{key:'clearInstanceAssigns',value:function clearInstanceAssigns(){return this.scopes[0]={}}},{key:'set',value:function set$$1(j,l){return this.scopes[0][j]=l}},{key:'get',value:function get$$1(j){return this.resolve(j)}},{key:'hasKey',value:function hasKey(j){return Promise.resolve(this.resolve(j)).then(function(l){return null!=l})}},{key:'resolve',value:function resolve(j){var m=this,l=void 0;if(a.Literals.hasOwnProperty(j))return a.Literals[j];if(l=/^'(.*)'$/.exec(j))return l[1];if(l=/^"(.*)"$/.exec(j))return l[1];if(l=/^(\d+)$/.exec(j))return+l[1];if(l=/^\((\S+)\.\.(\S+)\)$/.exec(j)){var _ret=function(){var n=m.resolve(l[1]),p=m.resolve(l[2]);return{v:Promise.all([n,p]).then(function(){var _Array$from=Array.from(0>=arguments.length?void 0:arguments[0]),_Array$from2=slicedToArray(_Array$from,2);return lo=_Array$from2[0],hi=_Array$from2[1],n=+n,p=+p,isNaN(n)||isNaN(p)?[]:new Range(n,p+1)})}}();if('object'===('undefined'==typeof _ret?'undefined':_typeof(_ret)))return _ret.v}else return(l=/^(\d[\d\.]+)$/.exec(j))?+l[1]:this.variable(j)}},{key:'findVariable',value:function findVariable(j){var n=this,l=void 0,m=void 0;if(this.scopes.some(function(p){if(p.hasOwnProperty(j))return l=p,!0}),null==l&&this.environments.some(function(p){if(m=n.lookupAndEvaluate(p,j),null!=m)return l=p}),null==l)if(0<this.environments.length)l=this.environments[this.environments.length-1];else if(0<this.scopes.length)l=this.scopes[this.scopes.length-1];else throw new Error('No scopes to find variable in.');return null==m&&(m=this.lookupAndEvaluate(l,j)),Promise.resolve(m).then(function(p){return n.liquify(p)})}},{key:'variable',value:function variable(j){var l=this;return Promise.resolve().then(function(){var n,p=helpers.scan(j,Liquid$1.VariableParser),q=/^\[(.*)\]$/,r=p.shift();(n=q.exec(r))&&(r=n[1]);var s=l.findVariable(r);if(0===p.length)return s;var t=function(u,w){return null==w?Promise.resolve(w):Promise.resolve(w).then(l.liquify.bind(l)).then(function(y){if(null==y)return y;var z=q.exec(u);return z&&(u=l.resolve(z[1])),Promise.resolve(u).then(function(A){var B=Array.isArray(y)&&isFinite(A),C=y instanceof Object&&(__guardMethod__$1(y,'hasKey',function(E){return E.hasKey(A)})||A in y),D=!z&&y&&(Array.isArray(y)||'[object String]'===Object.prototype.toString.call(y))&&0<=['size','first','last'].indexOf(A);if(B||C)return Promise.resolve(l.lookupAndEvaluate(y,A)).then(l.liquify.bind(l));if(D)switch(A){case'size':return l.liquify(y.length);case'first':return l.liquify(y[0]);case'last':return l.liquify(y[y.length-1]);default:throw new Error('Unknown special accessor: '+A);}})})},m=function(u,w){return w<p.length?t(p[w],u).then(function(y){return m(y,w+1)}):Promise.resolve(u)};return m(s,0).catch(function(u){throw new Error('Couldn\'t walk variable: '+j+': '+u)})})}},{key:'lookupAndEvaluate',value:function lookupAndEvaluate(j,l){return j instanceof Drop?j.get(l):__guard__$2(j,function(m){return m[l]})}},{key:'squashInstanceAssignsWithEnvironments',value:function squashInstanceAssignsWithEnvironments(){var l=this,j=this.lastScope();return Object.keys(j).forEach(function(m){return l.environments.some(function(n){if(n.hasOwnProperty(m))return j[m]=l.lookupAndEvaluate(n,m),!0})})}},{key:'liquify',value:function liquify(j){var l=this;return Promise.resolve(j).then(function(m){return null==m?m:('function'==typeof m.toLiquid?m=m.toLiquid():'object'!==('undefined'==typeof m?'undefined':_typeof(m))&&('function'==typeof m?m='':Object.prototype.toString.call(m)),m instanceof Drop&&(m.context=l),m)})}}]),a}();Context.initClass();function __guard__$2(a,b){return'undefined'!=typeof a&&null!==a?b(a):void 0}function __guardMethod__$1(a,b,c){return'undefined'!=typeof a&&null!==a&&'function'==typeof a[b]?c(a,b):void 0}

var LITERALS; var Condition=function(){function a(b,c,d){classCallCheck(this,a),this.left=b,this.operator=c,this.right=d,this.childRelation=null,this.childCondition=null;}return createClass(a,null,[{key:'initClass',value:function initClass(){var b;this.operators=(b={},defineProperty(b,'==',function _(c,d,e){return c.equalVariables(d,e)}),defineProperty(b,'is',function is(c,d,e){return c.equalVariables(d,e)}),defineProperty(b,'!=',function _(c,d,e){return!c.equalVariables(d,e)}),defineProperty(b,'<>',function _(c,d,e){return!c.equalVariables(d,e)}),defineProperty(b,'isnt',function isnt(c,d,e){return!c.equalVariables(d,e)}),defineProperty(b,'<',function _(c,d,e){return d<e}),defineProperty(b,'>',function _(c,d,e){return d>e}),defineProperty(b,'<=',function _(c,d,e){return d<=e}),defineProperty(b,'>=',function _(c,d,e){return d>=e}),defineProperty(b,'contains',function contains(c,d,e){return 0<=__guardMethod__(d,'indexOf',function(f){return f.indexOf(e)})}),b),LITERALS={empty:function empty(c){return!(0<__guard__$1(c,function(d){return d.length}))},blank:function blank(c){return!c||0===c.toString().length}};}}]),createClass(a,[{key:'evaluate',value:function evaluate(b){var d=this;null==b&&(b=new Context);var c=this.interpretCondition(this.left,this.right,this.operator,b);switch(this.childRelation){case'or':return Promise.resolve(c).then(function(e){return e||d.childCondition.evaluate(b)});case'and':return Promise.resolve(c).then(function(e){return e&&d.childCondition.evaluate(b)});default:return c;}}},{key:'or',value:function or(b){return this.childCondition=b,this.childRelation='or'}},{key:'and',value:function and(b){return this.childCondition=b,this.childRelation='and'}},{key:'attach',value:function attach(b){return this.attachment=b}},{key:'equalVariables',value:function equalVariables(b,c){return'function'==typeof b?b(c):'function'==typeof c?c(b):b===c}},{key:'resolveVariable',value:function resolveVariable(b,c){return b in LITERALS?Promise.resolve(LITERALS[b]):c.get(b)}},{key:'interpretCondition',value:function interpretCondition(b,c,d,e){var g=this;if(null==d)return this.resolveVariable(b,e);var f=a.operators[d];if(null==f)throw new Error('Unknown operator '+d);return b=this.resolveVariable(b,e),c=this.resolveVariable(c,e),Promise.all([b,c]).then(function(){var _Array$from=Array.from(0>=arguments.length?void 0:arguments[0]),_Array$from2=slicedToArray(_Array$from,2);return left=_Array$from2[0],right=_Array$from2[1],f(g,b,c)})}}]),a}();Condition.initClass();function __guardMethod__(a,b,c){return'undefined'!=typeof a&&null!==a&&'function'==typeof a[b]?c(a,b):void 0}function __guard__$1(a,b){return'undefined'!=typeof a&&null!==a?b(a):void 0}

var ElseCondition=function(a){function b(){return classCallCheck(this,b),possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return inherits(b,a),createClass(b,[{key:'evaluate',value:function evaluate(){return!0}}]),b}(Condition);

var SyntaxHelp$2; var Syntax$2; var WhenSyntax; var Case=function(a){function b(c,d,e){classCallCheck(this,b);var f=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));f.blocks=[];var g=Syntax$2.exec(e);if(!g)throw new Liquid$1.SyntaxError(SyntaxHelp$2);return f.markup=e,f}return inherits(b,a),createClass(b,null,[{key:'initClass',value:function initClass(){SyntaxHelp$2='Syntax Error in tag \'case\' - Valid syntax: case [expression]',Syntax$2=new RegExp('('+Liquid$1.QuotedFragment.source+')'),WhenSyntax=new RegExp('('+Liquid$1.QuotedFragment.source+')(?:(?:\\s+or\\s+|\\s*\\,\\s*)('+Liquid$1.QuotedFragment.source+'))?');}}]),createClass(b,[{key:'unknownTag',value:function unknownTag(c,d){return['when','else'].includes(c)?this.pushBlock(c,d):get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'unknownTag',this).apply(this,arguments)}},{key:'render',value:function render(c){var d=this;return c.stack(function(){return reduce(d.blocks,function(e,f){return null==e?Promise.resolve().then(function(){return f.evaluate(c)}).then(function(g){if(g)return f}):e},null).then(function(e){return null==e?'':d.renderAll(e.attachment,c)})})}},{key:'pushBlock',value:function pushBlock(c,d){var f=this,e=void 0;if('else'===c)return e=new ElseCondition,this.blocks.push(e),this.nodelist=e.attach([]);var _ret=function(){var g=helpers.scan(d,WhenSyntax),h=[];return{v:function(){var i=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var k,j=Array.from(g[0])[Symbol.iterator]();!(_iteratorNormalCompletion=(k=j.next()).done);_iteratorNormalCompletion=!0){var l=k.value,m=void 0;l&&(e=new Condition(f.markup,'==',l),f.blocks.push(e),m=f.nodelist=e.attach(h)),i.push(m);}}catch(n){_didIteratorError=!0,_iteratorError=n;}finally{try{!_iteratorNormalCompletion&&j.return&&j.return();}finally{if(_didIteratorError)throw _iteratorError}}return i}()}}();if('object'===('undefined'==typeof _ret?'undefined':_typeof(_ret)))return _ret.v}}]),b}(Block);Case.initClass();

var Raw=function(a){function b(){return classCallCheck(this,b),possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return inherits(b,a),createClass(b,[{key:'parse',value:function parse(c){var d=this;return Promise.resolve().then(function(){if(0===c.length||d.ended)return Promise.resolve();var e=c.shift(),f=Block.FullToken.exec(e.value);return __guard__$3(f,function(g){return g[1]})===d.blockDelimiter()?d.endTag():(d.nodelist.push(e.value),d.parse(c))})}}]),b}(Block);function __guard__$3(a,b){return'undefined'!=typeof a&&null!==a?b(a):void 0}

var Comment=function(a){function b(){return classCallCheck(this,b),possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return inherits(b,a),createClass(b,[{key:'render',value:function render(){return''}}]),b}(Raw);

var Decrement=function(a){function b(c,d,e){classCallCheck(this,b);var f=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return f.variable=e.trim(),f}return inherits(b,a),createClass(b,[{key:'render',value:function render(c){var d=c.environments[0][this.variable]||(c.environments[0][this.variable]=0);return--d,c.environments[0][this.variable]=d,d.toString()}}]),b}(Tag);

var isString=function(b){return'[object String]'===Object.prototype.toString.call(b)}; var Iterable=function(){function b(){classCallCheck(this,b);}return createClass(b,[{key:'first',value:function first(){return this.slice(0,1).then(function(c){return c[0]})}},{key:'map',value:function map(){var c=arguments;return this.toArray().then(function(d){return Promise.all(d.map.apply(d,toConsumableArray(c)))})}},{key:'sort',value:function sort(){var c=arguments;return this.toArray().then(function(d){return d.sort.apply(d,toConsumableArray(c))})}},{key:'toArray',value:function toArray$$1(){return this.slice(0)}},{key:'slice',value:function slice(){throw new Error(this.constructor.name+'.slice() not implemented')}},{key:'last',value:function last(){throw new Error(this.constructor.name+'.last() not implemented')}}],[{key:'cast',value:function cast(c){return c instanceof b?c:c instanceof Range?new IterableForArray(c.toArray()):Array.isArray(c)||isString(c)?new IterableForArray(c):null==c?new IterableForArray([]):new IterableForArray([c])}}]),b}();var IterableForArray=function(b){function c(d){classCallCheck(this,c);var e=possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments));return e.array=d,e}return inherits(c,b),createClass(c,[{key:'slice',value:function slice(){var d;return Promise.resolve((d=this.array).slice.apply(d,arguments))}},{key:'last',value:function last(){return Promise.resolve(this.array[this.array.length-1])}}]),c}(Iterable);

var SyntaxHelp$3; var Syntax$3; var For=function(a){function b(c,d,f){classCallCheck(this,b);var g=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments)),h=Syntax$3.exec(f);if(h)g.variableName=h[1],g.collectionName=h[2],g.registerName=h[1]+'='+h[2],g.reversed=h[3],g.attributes={},helpers.scan(f,Liquid$1.TagAttributes).forEach(function(i){return g.attributes[i[0]]=i[1]});else throw new Liquid$1.SyntaxError(SyntaxHelp$3);return g.nodelist=g.forBlock=[],g}return inherits(b,a),createClass(b,null,[{key:'initClass',value:function initClass(){SyntaxHelp$3='Syntax Error in \'for loop\' - Valid syntax: for [item] in [collection]',Syntax$3=new RegExp('(\\w+)\\s+in\\s+((?:'+Liquid$1.QuotedFragment.source+')+)\\s*(reversed)?');}}]),createClass(b,[{key:'unknownTag',value:function unknownTag(c){return'else'===c?this.nodelist=this.elseBlock=[]:get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'unknownTag',this).apply(this,arguments)}},{key:'render',value:function render(c){var d=this;return c.registers.for||(c.registers.for={}),Promise.resolve(c.get(this.collectionName)).then(function(f){if(__guard__$4(f,function(j){return j.forEach}));else if(f instanceof Object)f=function(){var j=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var m,l=Object.keys(f||{})[Symbol.iterator]();!(_iteratorNormalCompletion=(m=l.next()).done);_iteratorNormalCompletion=!0){var n=m.value,o=f[n];j.push([n,o]);}}catch(p){_didIteratorError=!0,_iteratorError=p;}finally{try{!_iteratorNormalCompletion&&l.return&&l.return();}finally{if(_didIteratorError)throw _iteratorError}}return j}();else return d.renderElse(c);var h='continue'===d.attributes.offset?+c.registers['for'][d.registerName]||0:+d.attributes.offset||0,g=d.attributes.limit,i=g?+g+h:null;return d.sliceCollection(f,h,i).then(function(j){if(0===j.length)return d.renderElse(c);d.reversed&&j.reverse();var l=j.length;return c.registers['for'][d.registerName]=h+j.length,c.stack(function(){return reduce(j,function(m,n,o){return c.set(d.variableName,n),c.set('forloop',{name:d.registerName,length:l,index:o+1,index0:o,rindex:l-o,rindex0:l-o-1,first:0===o,last:o===l-1}),Promise.resolve().then(function(){return d.renderAll(d.forBlock,c)}).then(function(p){return m.push(p),m}).catch(function(p){return m.push(c.handleError(p)),m})},[])})})})}},{key:'sliceCollection',value:function sliceCollection(c,d,f){var h,g=[d];return null!=f&&g.push(f),(h=Iterable.cast(c)).slice.apply(h,g)}},{key:'renderElse',value:function renderElse(c){return this.elseBlock?this.renderAll(this.elseBlock,c):''}}]),b}(Block);For.initClass();function __guard__$4(a,b){return'undefined'!=typeof a&&null!==a?b(a):void 0}

var SyntaxHelp$4; var Syntax$4; var ExpressionsAndOperators; var If=function(a){function b(c,d,e){classCallCheck(this,b);var f=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return f.blocks=[],f.pushBlock('if',e),f}return inherits(b,a),createClass(b,null,[{key:'initClass',value:function initClass(){SyntaxHelp$4='Syntax Error in tag \'if\' - Valid syntax: if [expression]',Syntax$4=new RegExp('('+Liquid$1.QuotedFragment.source+')\\s*([=!<>a-z_]+)?\\s*('+Liquid$1.QuotedFragment.source+')?'),ExpressionsAndOperators=new RegExp('(?:\\b(?:\\s?and\\s?|\\s?or\\s?)\\b|(?:\\s*(?!\\b(?:\\s?and\\s?|\\s?or\\s?)\\b)(?:'+Liquid$1.QuotedFragment.source+'|\\S+)\\s*)+)');}}]),createClass(b,[{key:'unknownTag',value:function unknownTag(c,d){return['elsif','else'].includes(c)?this.pushBlock(c,d):get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'unknownTag',this).apply(this,arguments)}},{key:'render',value:function render(c){var d=this;return c.stack(function(){return reduce(d.blocks,function(e,f){return null==e?Promise.resolve().then(function(){return f.evaluate(c)}).then(function(g){if(f.negate&&(g=!g),g)return f}):e},null).then(function(e){return null==e?'':d.renderAll(e.attachment,c)})})}},{key:'pushBlock',value:function pushBlock(c,d){var e=function(){if('else'===c)return new ElseCondition;var f=helpers.scan(d,ExpressionsAndOperators);f=f.reverse();var g=Syntax$4.exec(f.shift());if(!g)throw new Liquid$1.SyntaxError(SyntaxHelp$4);for(var i,h=new(Function.prototype.bind.apply(Condition,[null].concat(toConsumableArray(g.slice(1,4)))));0<f.length;){if(i=(f.shift()+'').trim(),g=Syntax$4.exec(f.shift()),!g)throw new SyntaxError(SyntaxHelp$4);var j=new(Function.prototype.bind.apply(Condition,[null].concat(toConsumableArray(g.slice(1,4)))));j[i].call(j,h),h=j;}return h}();return this.blocks.push(e),this.nodelist=e.attach([])}}]),b}(Block);If.initClass();

var IfChanged=function(a){function b(){return classCallCheck(this,b),possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return inherits(b,a),createClass(b,[{key:'render',value:function render(c){var d=this;return c.stack(function(){var e=d.renderAll(d.nodelist,c);return Promise.resolve(e).then(function(f){return f=helpers.toFlatString(f),f===c.registers.ifchanged?'':c.registers.ifchanged=f})})}}]),b}(Block);

var Syntax$5; var SyntaxHelp$5; var Include=function(a){function b(c,d,e){classCallCheck(this,b);var g=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments)),h=Syntax$5.exec(e);if(!h)throw new Liquid$1.SyntaxError(SyntaxHelp$5);return g.filepath=h[1],g.subTemplate=c.engine.fileSystem.readTemplateFile(g.filepath).then(function(j){return c.engine.parse(j)}),g}return inherits(b,a),createClass(b,null,[{key:'initClass',value:function initClass(){Syntax$5=/([a-z0-9\/\\_-]+)/i,SyntaxHelp$5='Syntax Error in \'include\' - Valid syntax: include [templateName]';}}]),createClass(b,[{key:'render',value:function render(c){return this.subTemplate.then(function(d){return d.render(c)})}}]),b}(Tag);Include.initClass();

var Increment=function(a){function b(c,d,e){classCallCheck(this,b);var f=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return f.variable=e.trim(),f}return inherits(b,a),createClass(b,[{key:'render',value:function render(c){var d=null==c.environments[0][this.variable]?c.environments[0][this.variable]=0:c.environments[0][this.variable];return c.environments[0][this.variable]=d+1,d+''}}]),b}(Tag);

function createCommonjsModule(fn, module) {
	return module = { exports: {} }, fn(module, module.exports), module.exports;
}

var strftime=createCommonjsModule(function(a){(function(){function b(p,q,r){function t(B,C,D,E){for(var L,F='',G=null,H=!1,I=B.length,J=!1,K=0;K<I;K++){if(L=B.charCodeAt(K),!0==H){if(45===L){G='';continue}else if(95===L){G=' ';continue}else if(48===L){G='0';continue}else if(58===L){J&&j('[WARNING] detected use of unsupported %:: or %::: modifiers to strftime'),J=!0;continue}switch(L){case 37:F+='%';break;case 65:F+=D.days[C.getDay()];break;case 66:F+=D.months[C.getMonth()];break;case 67:F+=c(Math.floor(C.getFullYear()/100),G);break;case 68:F+=t(D.formats.D,C,D,E);break;case 70:F+=t(D.formats.F,C,D,E);break;case 72:F+=c(C.getHours(),G);break;case 73:F+=c(e(C.getHours()),G);break;case 76:F+=d(Math.floor(E%1e3));break;case 77:F+=c(C.getMinutes(),G);break;case 80:F+=12>C.getHours()?D.am:D.pm;break;case 82:F+=t(D.formats.R,C,D,E);break;case 83:F+=c(C.getSeconds(),G);break;case 84:F+=t(D.formats.T,C,D,E);break;case 85:F+=c(f(C,'sunday'),G);break;case 87:F+=c(f(C,'monday'),G);break;case 88:F+=t(D.formats.X,C,D,E);break;case 89:F+=C.getFullYear();break;case 90:if(w&&0===v)F+='GMT';else{var M=C.toString().match(/\(([\w\s]+)\)/);F+=M&&M[1]||'';}break;case 97:F+=D.shortDays[C.getDay()];break;case 98:F+=D.shortMonths[C.getMonth()];break;case 99:F+=t(D.formats.c,C,D,E);break;case 100:F+=c(C.getDate(),G);break;case 101:F+=c(C.getDate(),null==G?' ':G);break;case 104:F+=D.shortMonths[C.getMonth()];break;case 106:var N=new Date(C.getFullYear(),0,1),O=Math.ceil((C.getTime()-N.getTime())/86400000);F+=d(O);break;case 107:F+=c(C.getHours(),null==G?' ':G);break;case 108:F+=c(e(C.getHours()),null==G?' ':G);break;case 109:F+=c(C.getMonth()+1,G);break;case 110:F+='\n';break;case 111:var O=C.getDate();F+=D.ordinalSuffixes?O+''+(D.ordinalSuffixes[O-1]||g(O)):O+''+g(O);break;case 112:F+=12>C.getHours()?D.AM:D.PM;break;case 114:F+=t(D.formats.r,C,D,E);break;case 115:F+=Math.floor(E/1e3);break;case 116:F+='\t';break;case 117:var O=C.getDay();F+=0===O?7:O;break;case 118:F+=t(D.formats.v,C,D,E);break;case 119:F+=C.getDay();break;case 120:F+=t(D.formats.x,C,D,E);break;case 121:F+=(''+C.getFullYear()).slice(2);break;case 122:if(w&&0===v)F+=J?'+00:00':'+0000';else{var P=0===v?-C.getTimezoneOffset():v/60000;var Q=0>P?'-':'+',R=J?':':'',S=Math.floor(Math.abs(P/60)),T=Math.abs(P%60);F+=Q+c(S)+R+c(T);}break;default:H&&(F+='%'),F+=B[K];}G=null,H=!1;continue}if(37===L){H=!0;continue}F+=B[K];}return F}var z,u=p||l,v=q||0,w=r||!1,x=0,A=function(B,C){var D;if(!C){var E=Date.now();E>x?(x=E,z=new Date(x),D=x,w&&(z=new Date(x+h(z)+v))):D=x,C=z;}else if(D=C.getTime(),w){var F=h(C);if(C=new Date(D+F+v),h(C)!==F){var G=h(C);C=new Date(D+G+v);}}return t(B,C,u,D)};return A.localize=function(B){return new b(B||u,v,w)},A.localizeByIdentifier=function(B){var C=k[B];return C?A.localize(C):(j('[WARNING] No locale found with identifier "'+B+'".'),A)},A.timezone=function(B){var C=v,D=w,E='undefined'==typeof B?'undefined':_typeof(B);if('number'===E||'string'===E)if(D=!0,'string'===E){var F='-'===B[0]?-1:1,G=parseInt(B.slice(1,3),10),H=parseInt(B.slice(3,5),10);C=1e3*(60*(F*(60*G+H)));}else'number'===E&&(C=1e3*(60*B));return new b(u,C,D)},A.utc=function(){return new b(u,v,!0)},A}function c(p,q){return''===q||9<p?p:(null==q&&(q='0'),q+p)}function d(p){return 99<p?p:9<p?'0'+p:'00'+p}function e(p){if(0===p)return 12;return 12<p?p-12:p}function f(p,q){q=q||'sunday';var r=p.getDay();'monday'===q&&(0===r?r=6:r--);var s=Date.UTC(p.getFullYear(),0,1),t=Date.UTC(p.getFullYear(),p.getMonth(),p.getDate()),u=Math.floor((t-s)/8.64e7),v=(u+7-r)/7;return Math.floor(v)}function g(p){var q=p%10,r=p%100;if(11<=r&&13>=r||0==q||4<=q)return'th';return 1==q?'st':2==q?'nd':3==q?'rd':void 0}function h(p){return 6e4*(p.getTimezoneOffset()||0)}function j(p){'undefined'!=typeof console&&'function'==typeof console.warn&&console.warn(p);}var k={de_DE:{days:['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'],shortDays:['So','Mo','Di','Mi','Do','Fr','Sa'],months:['Januar','Februar','M\xE4rz','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'],shortMonths:['Jan','Feb','M\xE4r','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d.%m.%Y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},en_CA:{days:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],shortDays:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],ordinalSuffixes:['st','nd','rd','th','th','th','th','th','th','th','th','th','th','th','th','th','th','th','th','th','st','nd','rd','th','th','th','th','th','th','th','st'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d/%m/%y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%r',x:'%D'}},en_US:{days:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],shortDays:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],ordinalSuffixes:['st','nd','rd','th','th','th','th','th','th','th','th','th','th','th','th','th','th','th','th','th','st','nd','rd','th','th','th','th','th','th','th','st'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%m/%d/%y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%r',x:'%D'}},es_MX:{days:['domingo','lunes','martes','mi\xE9rcoles','jueves','viernes','s\xE1bado'],shortDays:['dom','lun','mar','mi\xE9','jue','vie','s\xE1b'],months:['enero','febrero','marzo','abril','mayo','junio','julio','agosto','septiembre','octubre','noviembre',' diciembre'],shortMonths:['ene','feb','mar','abr','may','jun','jul','ago','sep','oct','nov','dic'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d/%m/%Y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},fr_FR:{days:['dimanche','lundi','mardi','mercredi','jeudi','vendredi','samedi'],shortDays:['dim.','lun.','mar.','mer.','jeu.','ven.','sam.'],months:['janvier','f\xE9vrier','mars','avril','mai','juin','juillet','ao\xFBt','septembre','octobre','novembre','d\xE9cembre'],shortMonths:['janv.','f\xE9vr.','mars','avril','mai','juin','juil.','ao\xFBt','sept.','oct.','nov.','d\xE9c.'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d/%m/%Y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},it_IT:{days:['domenica','luned\xEC','marted\xEC','mercoled\xEC','gioved\xEC','venerd\xEC','sabato'],shortDays:['dom','lun','mar','mer','gio','ven','sab'],months:['gennaio','febbraio','marzo','aprile','maggio','giugno','luglio','agosto','settembre','ottobre','novembre','dicembre'],shortMonths:['pr','mag','giu','lug','ago','set','ott','nov','dic'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d/%m/%Y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},nl_NL:{days:['zondag','maandag','dinsdag','woensdag','donderdag','vrijdag','zaterdag'],shortDays:['zo','ma','di','wo','do','vr','za'],months:['januari','februari','maart','april','mei','juni','juli','augustus','september','oktober','november','december'],shortMonths:['jan','feb','mrt','apr','mei','jun','jul','aug','sep','okt','nov','dec'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d-%m-%y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},pt_BR:{days:['domingo','segunda','ter\xE7a','quarta','quinta','sexta','s\xE1bado'],shortDays:['Dom','Seg','Ter','Qua','Qui','Sex','S\xE1b'],months:['janeiro','fevereiro','mar\xE7o','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'],shortMonths:['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X %Z',D:'%d-%m-%Y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},ru_RU:{days:['\u0412\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435','\u041F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A','\u0412\u0442\u043E\u0440\u043D\u0438\u043A','\u0421\u0440\u0435\u0434\u0430','\u0427\u0435\u0442\u0432\u0435\u0440\u0433','\u041F\u044F\u0442\u043D\u0438\u0446\u0430','\u0421\u0443\u0431\u0431\u043E\u0442\u0430'],shortDays:['\u0412\u0441','\u041F\u043D','\u0412\u0442','\u0421\u0440','\u0427\u0442','\u041F\u0442','\u0421\u0431'],months:['\u042F\u043D\u0432\u0430\u0440\u044C','\u0424\u0435\u0432\u0440\u0430\u043B\u044C','\u041C\u0430\u0440\u0442','\u0410\u043F\u0440\u0435\u043B\u044C','\u041C\u0430\u0439','\u0418\u044E\u043D\u044C','\u0418\u044E\u043B\u044C','\u0410\u0432\u0433\u0443\u0441\u0442','\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C','\u041E\u043A\u0442\u044F\u0431\u0440\u044C','\u041D\u043E\u044F\u0431\u0440\u044C','\u0414\u0435\u043A\u0430\u0431\u0440\u044C'],shortMonths:['\u044F\u043D\u0432','\u0444\u0435\u0432','\u043C\u0430\u0440','\u0430\u043F\u0440','\u043C\u0430\u0439','\u0438\u044E\u043D','\u0438\u044E\u043B','\u0430\u0432\u0433','\u0441\u0435\u043D','\u043E\u043A\u0442','\u043D\u043E\u044F','\u0434\u0435\u043A'],AM:'AM',PM:'PM',am:'am',pm:'pm',formats:{c:'%a %d %b %Y %X',D:'%d.%m.%y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},tr_TR:{days:['Pazar','Pazartesi','Sal\u0131','\xC7ar\u015Famba','Per\u015Fembe','Cuma','Cumartesi'],shortDays:['Paz','Pzt','Sal','\xC7r\u015F','Pr\u015F','Cum','Cts'],months:['Ocak','\u015Eubat','Mart','Nisan','May\u0131s','Haziran','Temmuz','A\u011Fustos','Eyl\xFCl','Ekim','Kas\u0131m','Aral\u0131k'],shortMonths:['Oca','\u015Eub','Mar','Nis','May','Haz','Tem','A\u011Fu','Eyl','Eki','Kas','Ara'],AM:'\xD6\xD6',PM:'\xD6S',am:'\xD6\xD6',pm:'\xD6S',formats:{c:'%a %d %b %Y %X %Z',D:'%d-%m-%Y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%T',x:'%D'}},zh_CN:{days:['\u661F\u671F\u65E5','\u661F\u671F\u4E00','\u661F\u671F\u4E8C','\u661F\u671F\u4E09','\u661F\u671F\u56DB','\u661F\u671F\u4E94','\u661F\u671F\u516D'],shortDays:['\u65E5','\u4E00','\u4E8C','\u4E09','\u56DB','\u4E94','\u516D'],months:['\u4E00\u6708\u4EFD','\u4E8C\u6708\u4EFD','\u4E09\u6708\u4EFD','\u56DB\u6708\u4EFD','\u4E94\u6708\u4EFD','\u516D\u6708\u4EFD','\u4E03\u6708\u4EFD','\u516B\u6708\u4EFD','\u4E5D\u6708\u4EFD','\u5341\u6708\u4EFD','\u5341\u4E00\u6708\u4EFD','\u5341\u4E8C\u6708\u4EFD'],shortMonths:['\u4E00\u6708','\u4E8C\u6708','\u4E09\u6708','\u56DB\u6708','\u4E94\u6708','\u516D\u6708','\u4E03\u6708','\u516B\u6708','\u4E5D\u6708','\u5341\u6708','\u5341\u4E00\u6708','\u5341\u4E8C\u6708'],AM:'\u4E0A\u5348',PM:'\u4E0B\u5348',am:'\u4E0A\u5348',pm:'\u4E0B\u5348',formats:{c:'%a %d %b %Y %X %Z',D:'%d/%m/%y',F:'%Y-%m-%d',R:'%H:%M',r:'%I:%M:%S %p',T:'%H:%M:%S',v:'%e-%b-%Y',X:'%r',x:'%D'}}},l=k.en_US,m=new b(l,0,!1),o;o=a.exports=m,'function'!=typeof Date.now&&(Date.now=function(){return+new Date});})();});

var toNumber=function(c){return+c}; var toObjectString=Object.prototype.toString; var hasOwnProperty=Object.prototype.hasOwnProperty; var isString$1=function(c){return'[object String]'===toObjectString.call(c)}; var isArray=function(c){return Array.isArray(c)}; var isArguments=function(c){return'[object Arguments]'===toObjectString(c)}; var isNumber=function(c){return!isArray(c)&&0<=c-parseFloat(c)}; var toString=function(c){return null==c?'':isString$1(c)?c:'function'==typeof c.toString?toString(c.toString()):toObjectString.call(c)}; var toIterable=function(c){return Iterable.cast(c)}; var toDate=function(c){if(null!=c){if(c instanceof Date)return c;if('now'===c)return new Date;if(isNumber(c))c=parseInt(c);else{if(c=toString(c),0===c.length)return;c=Date.parse(c);}return null==c?void 0:new Date(c)}}; var has=function(c,d){return null!=c&&hasOwnProperty.call(c,d)}; var isEmpty=function(c){if(null==c)return!0;if(isArray(c)||isString$1(c)||isArguments(c))return 0===c.length;for(var d in c)(function(){if(has(d,c))return!1})();return!0}; var isBlank=function(c){return!(isNumber(c)||!0===c)&&isEmpty(c)}; var HTML_ESCAPE=function(c){return'&'===c?'&amp;':'>'===c?'&gt;':'<'===c?'&lt;':'"'===c?'&quot;':'\''===c?'&#39;':void 0}; var HTML_ESCAPE_ONCE_REGEXP=/["><']|&(?!([a-zA-Z]+|(#\d+));)/g; var HTML_ESCAPE_REGEXP=/([&><"'])/g;var StandardFilters = {size:function size(c){return null==__guard__$5(c,function(d){return d.length})?0:__guard__$5(c,function(d){return d.length})},downcase:function downcase(c){return toString(c).toLowerCase()},upcase:function upcase(c){return toString(c).toUpperCase()},append:function append(c,d){return toString(c)+toString(d)},prepend:function prepend(c,d){return toString(d)+toString(c)},empty:function empty(c){return isEmpty(c)},capitalize:function capitalize(c){return toString(c).replace(/^([a-z])/,function(d,f){return f.toUpperCase()})},sort:function sort(c,d){return null==d?toIterable(c).sort():toIterable(c).map(function(f){return Promise.resolve(__guard__$5(f,function(g){return g[d]})).then(function(g){return{key:g,item:f}})}).then(function(f){return f.sort(function(g,h){var i,j;return null==(i=g.key>h.key)?defineProperty({},1,null==(j=g.key===h.key)?defineProperty({},0,-1):j):i}).map(function(g){return g.item})})},map:function map(c,d){return null==d?c:toIterable(c).map(function(f){return __guard__$5(f,function(g){return g[d]})})},escape:function escape(c){return toString(c).replace(HTML_ESCAPE_REGEXP,HTML_ESCAPE)},escape_once:function escape_once(c){return toString(c).replace(HTML_ESCAPE_ONCE_REGEXP,HTML_ESCAPE)},strip_html:function strip_html(c){return toString(c).replace(/<script[\s\S]*?<\/script>/g,'').replace(/<!--[\s\S]*?-->/g,'').replace(/<style[\s\S]*?<\/style>/g,'').replace(/<[^>]*?>/g,'')},strip_newlines:function strip_newlines(c){return toString(c).replace(/\r?\n/g,'')},newline_to_br:function newline_to_br(c){return toString(c).replace(/\n/g,'<br />\n')},replace:function replace(c,d,f){return null==f&&(f=''),toString(c).replace(new RegExp(d,'g'),f)},replace_first:function replace_first(c,d,f){return null==f&&(f=''),toString(c).replace(d,f)},remove:function remove(c,d){return this.replace(c,d)},remove_first:function remove_first(c,d){return this.replace_first(c,d)},truncate:function truncate(c,d,f){null==d&&(d=50),null==f&&(f='...'),c=toString(c),f=toString(f),d=toNumber(d);var g=d-f.length;return 0>g&&(g=0),c.length>d?c.slice(0,g)+f:c},truncatewords:function truncatewords(c,d,f){null==d&&(d=15),null==f&&(f='...'),c=toString(c);var g=c.split(' ');return d=Math.max(1,toNumber(d)),g.length>d?g.slice(0,d).join(' ')+f:c},split:function split(c,d){return c=toString(c),c?c.split(d):void 0},flatten:function flatten(c){return toIterable(c).toArray().then(function(d){return helpers.flatten(d)})},join:function join(c,d){return null==d&&(d=' '),this.flatten(c).then(function(f){return f.join(d)})},first:function first(c){return toIterable(c).first()},last:function last(c){return toIterable(c).last()},plus:function plus(c,d){return toNumber(c)+toNumber(d)},minus:function minus(c,d){return toNumber(c)-toNumber(d)},times:function times(c,d){return toNumber(c)*toNumber(d)},dividedBy:function dividedBy(c,d){return toNumber(c)/toNumber(d)},divided_by:function divided_by(c,d){return this.dividedBy(c,d)},round:function round(c,d){return toNumber(c).toFixed(d)},modulo:function modulo(c,d){return toNumber(c)%toNumber(d)},date:function date(c,d){return c=toDate(c),null==c?'':0===toString(d).length?c.toUTCString():strftime(d,c)},default:function _default(c,d){var f;2>arguments.length&&(d='');var g=null==(f=__guardMethod__$2(c,'isBlank',function(h){return h.isBlank()}))?isBlank(c):f;return g?d:c}};function __guard__$5(c,d){return'undefined'!=typeof c&&null!==c?d(c):void 0}function __guardMethod__$2(c,d,f){return'undefined'!=typeof c&&null!==c&&'function'==typeof c[d]?f(c,d):void 0}

var Document=function(a){function b(c){classCallCheck(this,b);var d=possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return d.template=c,d}return inherits(b,a),createClass(b,[{key:'blockDelimiter',value:function blockDelimiter(){return[]}},{key:'assertMissingDelimitation',value:function assertMissingDelimitation(){}}]),b}(Block);

var Template=function(){function a(){classCallCheck(this,a),this.registers={},this.assigns={},this.instanceAssigns={},this.tags={},this.errors=[],this.rethrowErrors=!0;}return createClass(a,[{key:'parse',value:function parse(b,c){var d=this;return this.engine=b,null==c&&(c=''),Promise.resolve().then(function(){var e=d._tokenize(c);return d.tags=d.engine.tags,d.root=new Document(d),d.root.parseWithCallbacks(e).then(function(){return d})})}},{key:'render',value:function render(){for(var e=this,c=arguments.length,b=Array(c),d=0;d<c;d++)b[d]=arguments[d];return Promise.resolve().then(function(){return e._render.apply(e,b)})}},{key:'_render',value:function _render(b,c){var e=this;if(null==this.root)throw new Error('No document root. Did you parse the document yet?');var d=function(){if(b instanceof Context)return b;if(b instanceof Object)return b=[b,e.assigns],new Context(e.engine,b,e.instanceAssigns,e.registers,e.rethrowErrors);if(null==b)return new Context(e.engine,e.assigns,e.instanceAssigns,e.registers,e.rethrowErrors);throw new Error('Expected Object or Context as parameter, but was '+('undefined'==typeof b?'undefined':_typeof(b))+'.')}();if(__guard__$6(c,function(l){return l.registers})){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var g,f=Object.keys(c.registers||{})[Symbol.iterator]();!(_iteratorNormalCompletion=(g=f.next()).done);_iteratorNormalCompletion=!0){var h=g.value,i=c.registers[h];this.registers[h]=i;}}catch(l){_didIteratorError=!0,_iteratorError=l;}finally{try{!_iteratorNormalCompletion&&f.return&&f.return();}finally{if(_didIteratorError)throw _iteratorError}}}__guard__$6(c,function(l){return l.filters})&&d.registerFilters.apply(d,toConsumableArray(c.filters));return this.root.render(d).then(function(l){return helpers.toFlatString(l)}).then(function(l){return e.errors=d.errors,l},function(l){throw e.errors=d.errors,l})}},{key:'_tokenize',value:function _tokenize(b){if(b+='',0===b.length)return[];var c=b.split(Liquid$1.TemplateParser),d=1,e=1;return c.filter(function(f){return 0<f.length}).map(function(f){var g={value:f,col:e,line:d},h=f.lastIndexOf('\n');if(0>h)e+=f.length;else{var i=f.split('\n').length-1;d+=i,e=f.length-h;}return g})}}]),a}();function __guard__$6(a,b){return'undefined'!=typeof a&&null!==a?b(a):void 0}

var Unless=function(a){function b(){return classCallCheck(this,b),possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return inherits(b,a),createClass(b,[{key:'parse',value:function parse(){var c=this;return get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'parse',this).apply(this,arguments).then(function(){return c.blocks[0].negate=!0})}}]),b}(If);

var Engine=function(){function a(){classCallCheck(this,a),this.tags={assign:Assign,capture:Capture,case:Case,comment:Comment,decrement:Decrement,for:For,if:If,ifchanged:IfChanged,include:Include,increment:Increment,raw:Raw,unless:Unless},this.Strainer=function(e){this.context=e;},this.registerFilters(StandardFilters),this.fileSystem=new BlankFileSystem;}return createClass(a,[{key:'registerFilters',value:function registerFilters(){for(var h=this,f=arguments.length,e=Array(f),g=0;g<f;g++)e[g]=arguments[g];return e.forEach(function(i){return function(){var j=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var m,l=Object.keys(i||{})[Symbol.iterator]();!(_iteratorNormalCompletion=(m=l.next()).done);_iteratorNormalCompletion=!0){var n=m.value,o=i[n],p=void 0;o instanceof Function&&(p=h.Strainer.prototype[n]=o),j.push(p);}}catch(q){_didIteratorError=!0,_iteratorError=q;}finally{try{!_iteratorNormalCompletion&&l.return&&l.return();}finally{if(_didIteratorError)throw _iteratorError}}return j}()})}},{key:'parse',value:function parse(e){var f=new Template;return f.parse(this,e)}},{key:'parseAndRender',value:function parseAndRender(e){for(var g=arguments.length,f=Array(1<g?g-1:0),h=1;h<g;h++)f[h-1]=arguments[h];return this.parse(e).then(function(i){return i.render.apply(i,f)})}},{key:'registerFileSystem',value:function registerFileSystem(e){if(!(e instanceof BlankFileSystem))throw Liquid.ArgumentError('Must be subclass of BlankFileSystem');return this.fileSystem=e}}]),a}();

export { Engine, BlankFileSystem };
